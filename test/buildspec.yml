# Build Spec for AWS CodeBuild CI

version: 0.2

phases:
  install:
    commands:
      - apt-get update
      - apt-get install sudo -y
      - apt-get install -y python3.8
      - curl -O https://bootstrap.pypa.io/get-pip.py && python3.8 get-pip.py
      - update-alternatives --install /usr/bin/python python /usr/bin/python3.8 1
      - update-alternatives --install /usr/local/bin/pip pip /usr/local/bin/pip3 1
      - python ts_scripts/install_dependencies.py --environment=dev

  build:
    commands:
      - /bin/bash -c "set -eo pipefail; python test/regression_tests.py 2>&1 | tee /tmp/test_exec.log"

artifacts:
  files:
    - /tmp/test_exec.log
  name: TS-NIGHTLY-REGRESSION-$(date +%Y-%m-%d)
